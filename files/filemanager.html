<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>GitHub File Manager</title>
<style>
    body { font-family: Arial, sans-serif; padding: 20px; }
    ul { list-style-type: none; padding-left: 20px; }
    li { margin: 5px 0; }
    a { text-decoration: none; color: #0366d6; }
    a:hover { text-decoration: underline; }
    .folder { font-weight: bold; cursor: pointer; }
</style>
</head>
<body>
<h1>GitHub File Manager</h1>
<div>
    <label>Repo (owner/repo): <input id="repoInput" placeholder="username/repo" /></label>
    <label>Branch: <input id="branchInput" value="main" /></label>
    <button onclick="loadRepo()">Load</button>
</div>
<ul id="fileTree"></ul>

<script>
async function fetchFolder(owner, repo, path = '', branch = 'main') {
    const url = `https://api.github.com/repos/${owner}/${repo}/contents/${path}?ref=${branch}`;
    const res = await fetch(url);
    if (!res.ok) throw new Error('Error fetching repo');
    return await res.json();
}

function createFileLink(item, owner, repo, branch) {
    const li = document.createElement('li');
    if (item.type === 'dir') {
        li.textContent = '📁 ' + item.name;
        li.classList.add('folder');
        li.onclick = async (e) => {
            e.stopPropagation();
            if (li.querySelector('ul')) {
                li.querySelector('ul').remove();
            } else {
                const ul = document.createElement('ul');
                const contents = await fetchFolder(owner, repo, item.path, branch);
                contents.forEach(child => ul.appendChild(createFileLink(child, owner, repo, branch)));
                li.appendChild(ul);
            }
        }
    } else if (item.type === 'file') {
        const a = document.createElement('a');
        a.textContent = '📄 ' + item.name;
        a.href = `https://raw.githubusercontent.com/${owner}/${repo}/${branch}/${item.path}`;
        a.target = '_blank';
        li.appendChild(a);
    }
    return li;
}

async function loadRepo() {
    const repoInput = document.getElementById('repoInput').value.trim();
    const branch = document.getElementById('branchInput').value.trim() || 'main';
    const [owner, repo] = repoInput.split('/');
    if (!owner || !repo) return alert('Invalid repo format');
    const fileTree = document.getElementById('fileTree');
    fileTree.innerHTML = '';
    try {
        const contents = await fetchFolder(owner, repo, '', branch);
        contents.forEach(item => fileTree.appendChild(createFileLink(item, owner, repo, branch)));
    } catch (e) {
        alert(e.message);
    }
}
</script>
</body>
</html>
